## Overview
This page provides how to preprocess your inputs for setting up GALigandDock runs. Note that many of current preprocessing stages require running external softwares, since GALigandDock is still a new application and not many effort has been made to improve its user interface. Many of preprocessing stages listed below will be simplified or unified into our own script in the future so that users can easily setup docking runs.

### 1. Make a proper mol2 file
Prepare a "proper" mol2 file starting from either SMILES string or a mol2 file.
(see below NOTES:HOW-TO-MAKE-PROPER-MOL2 if you are not sure with yours)

### 2. Partial charge assignment
Add AM1-BCC partial charge to your mol2file. You can skip this stage if you are going to 
run partial charge calculation through mol2genparams.py in stage3 below, although it is still unstable and for now we recommend running external softwares listed below.

#### Using UCSF chimera
- open UCSF chimera (download if you don't have it; its academically free)
- tools -> Add Charges -> Switch "other residues" to "AM1-BCC" -> click OK -> assign proper Net charge -> OK

#### Using Antechamber from AMBERTOOLS
- If you have AMBERTOOLS installed, run:
$AMBERHOME/bin/antechamber -i [input.mol2] -fi mol2 -o [output.mol2] -fo mol2 -c bcc -nc [netcharge] 

### 3. Making a generic-atom-type-version Rosetta params file

$ROSETTA/source/scripts/python/public/generic_potential/mol2genparams.py -s [your.mol2]

Expected outputs are:
- [your].params and
- [your]_0001.pdb; a ligand pdb file with coordinates copied from input mol2 file.

```html
Usage: python mol2genparams.py [-s mol2file or -l mol2filelist] [options]

Options:
  -h, --help            show this help message and exit
  -s INPUTS, --inputs=INPUTS
  -l L                  
  --nm=RESNAME, --resname=RESNAME
                        Residue name
  --auto_nm=AUTO_RESPREFIX
                        Automatically rename resname starting with argument;
                        default L[00-99]
  --am1bcc              Calculate am1bcc charge (currently am1 part only; bcc will be added soon)
  --prefix=PREFIX       Prefix of output names
                        (prefix.params,prefix_0001.pdb), default as the prefix
                        of input mol2 file
  --debug               Report verbose output for debugging
  --no_output           Do not report params or pdb
  --funcgrp             Report functional group assignment to stdout
  --elec_cp_rep         Report elec-countpair info to [prefix].elec_cp_ref
  --elec_grpdef         Report elec-grp-definition info to [prefix].grpref
  --puckering_chi       Define ring puckering torsions as rotatable CHI
  --amide_chi           Define amide as rotatable CHI
  --freeze_ringring     Define  as rotatable CHI
```

**Notes:**

* Requires numpy and scipy installed in order to run the script.
* Requires numba installation for --am1bcc option. This can be readily installed through Anaconda.

### 4.Making an input "holo.pdb" file
- Translate coordinates in your ligand pdb file generated at stage3 so that its center-of-mass locates at a proper position inside the pocket. We __strongly__ recommend running this application __when you know (at least approximate) location of the pocket__. If not, you can get a "holo.pdb" by running PatchDock server (https://bioinfo3d.cs.tau.ac.il/PatchDock/); please follow instruction there.
- Make sure contents of your ligand of interest locate at the end of holo.pdb, which means HETATM lines for any cofactor(s) / metals / waters should locate above it.

### NOTES
#### Conformer generation is not necessary
Skip conformer generation! You don't need it anymore. Any single conformation is enough as input and docking tool will take care of rest of conformer sampling even beyond what could be generated by typical conformer generation tools.

#### HOW TO MAKE A PROPER MOL2 FILE
**1. If your input is in pdb or mol2 format**
Requires installation of OpenBabel (http://openbabel.org/wiki/Main_Page). If it is pdb format, first strip ligand part in your pdb file as "ligand.pdb", then run:
```
obabel -i pdb ligand.pdb -o mol2 -O ligand.mol2 
```

Attaching missing hydrogens starting from mol2 format (still careful visual inspection recommend afterwards):
```
obabel -i mol2 ligand.mol2 -o mol2 -O ligandH.mol2 -p [pH of your interest; usually 7.0]
```

**2. If your input is in SMILES string**
There are multiple ways of converting SMILES to mol2 file, you can use Openbable as well. We recommend online demo version of Corina:
https://www.mn-am.com/online_demos/corina_demo